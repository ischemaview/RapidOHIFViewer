"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[799],{91799:function(e,t,n){n.r(t);var r=n(32735),a=n(60216),i=n.n(a),o=n(72928),l=n(84334),s=n(67013),c=n(38942),u=n(89784),m=n(77180),f=n(96257),d=n(56789);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=o.ZP.formatDate;function b(e){e.children;var t=e.displaySets,n=e.viewportIndex,a=e.viewportLabel,i=e.servicesManager,o=e.extensionManager,g=e.commandsManager,b=((0,c.$G)("TrackedViewport").t,i.services),h=b.MeasurementService,S=b.CornerstoneViewportService,w=t[0],E=v((0,d.I)(),1)[0],x=v((0,s.O_)(),1)[0].activeViewportIndex,C=v((0,s.vQ)(),2),P=C[0],N=P.isCineEnabled,k=P.cines,I=C[1],A=v((0,s.en)(),1)[0],M=v((0,r.useState)(!1),2),O=M[0],T=M[1],D=v((0,r.useState)(null),2),R=D[0],V=D[1],j=v((0,r.useState)(null),2),Z=j[0],F=j[1],_=E.context.trackedSeries,K=S.getViewportId(n),W=(w.Modality,w.SeriesDate),q=w.SeriesDescription,L=w.SeriesInstanceUID,U=w.SeriesNumber,J=w.images[0],$=J.PatientID,B=J.PatientName,G=J.PatientSex,Q=J.PatientAge,Y=J.SliceThickness,z=J.SpacingBetweenSlices,H=J.ManufacturerModelName,X=function(){if(k&&k[n]&&Z){var e=k[n],t=e.isPlaying||!1,r=e.frameRate||24,a=Math.max(r,1);t?I.playClip(Z,{framesPerSecond:a}):I.stopClip(Z)}};(0,r.useEffect)((function(){return O?(f.Z.setViewportToolStyles(K,{global:{lineDash:""}}),void S.getRenderingEngine().renderViewport(K)):(f.Z.setViewportToolStyles("viewport-".concat(n),{global:{lineDash:"4,4"}}),S.getRenderingEngine().renderViewport(K),function(){f.Z.setViewportToolStyles(K,{})})}),[O]),(0,r.useEffect)((function(){return u.Z.addEventListener(m.Z.STACK_VIEWPORT_NEW_STACK,X),function(){I.setCine({id:n,isPlaying:!1}),u.Z.removeEventListener(m.Z.STACK_VIEWPORT_NEW_STACK,X)}}),[Z]),(0,r.useEffect)((function(){if(k&&k[n]&&Z)return X(),function(){var e;Z&&null!=k&&null!==(e=k[n])&&void 0!==e&&e.isPlaying&&I.stopClip(Z)}}),[k,n,I,Z,X]),_.includes(L)!==O&&T(!O);var ee=function(e){F(e.detail.element)};var te,ne=k[n],re=ne&&ne.isPlaying||!1;return r.createElement(r.Fragment,null,r.createElement(s.uY,{onDoubleClick:function(e){e.stopPropagation(),e.preventDefault()},useAltStyling:O,onArrowsClick:function(e){return function(e){var t=function(e,t,n,r){var a=t.services.MeasurementService.getMeasurements(),i=r.context.trackedSeries,o=a.filter((function(e){return i.includes(e.referenceSeriesUID)}));if(o.length){var l=o.length,s=o.map((function(e){return e.uid})),c=s.findIndex((function(e){return e===n}));return-1===c?c=0:"left"===e?--c<0&&(c=l-1):"right"===e&&++c===l&&(c=0),s[c]}}(e,i,R,E);t&&(V(t),h.jumpToMeasurement(n,t))}(e)},getStatusComponent:function(){return function(e){var t=e?"tracked":"dotted-circle";return r.createElement("div",{className:"relative"},r.createElement(s.u,{position:"bottom-left",content:r.createElement("div",{className:"flex py-2"},r.createElement("div",{className:"flex pt-1"},r.createElement(s.JO,{name:"info-link",className:"w-4 text-primary-main"})),r.createElement("div",{className:"flex ml-4"},r.createElement("span",{className:"text-base text-common-light"},e?r.createElement(r.Fragment,null,"Series is",r.createElement("span",{className:"font-bold text-white"}," tracked")," and can be viewed ",r.createElement("br",null)," in the measurement panel"):r.createElement(r.Fragment,null,"Measurements for",r.createElement("span",{className:"font-bold text-white"}," untracked "),"series ",r.createElement("br",null)," will not be shown in the ",r.createElement("br",null)," measurements panel"))))},r.createElement(s.JO,{name:t,className:"w-6 text-primary-light"})))}(O)},studyData:{label:a,studyDate:y(W),currentSeries:U,seriesDescription:q,patientInformation:{patientName:B?l.ZP.utils.formatPN(B.Alphabetic):"",patientSex:G||"",patientAge:Q||"",MRN:$||"",thickness:Y?"".concat(parseFloat(Y).toFixed(2),"mm"):"",spacing:void 0!==z?"".concat(parseFloat(z).toFixed(2),"mm"):"",scanner:H||""}},showNavArrows:!N,showCine:N,cineProps:{isPlaying:re,onClose:function(){return g.runCommand("toggleCine")},onPlayPauseChange:function(e){return I.setCine({id:x,isPlaying:e})},onFrameRateChange:function(e){return I.setCine({id:x,frameRate:e})}}}),r.createElement("div",{className:"relative flex flex-row w-full h-full overflow-hidden"},(te=o.getModuleEntry("@ohif/extension-cornerstone.viewportModule.cornerstone").component,r.createElement(te,p({},e,{onElementEnabled:ee}))),r.createElement("div",{className:"absolute w-full"},A.viewportIndex===n&&r.createElement(s.P_,{id:A.id,message:A.message,type:A.type,actions:A.actions,onSubmit:A.onSubmit,onOutsideClick:A.onOutsideClick}))))}b.propTypes={displaySets:i().arrayOf(i().object.isRequired).isRequired,viewportIndex:i().number.isRequired,dataSource:i().object,children:i().node,customProps:i().object},b.defaultProps={customProps:{}},t.default=b}}]);
//# sourceMappingURL=799.bundle.9db066b9bd06b1313125.js.map